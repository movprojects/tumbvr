!function t(e,i,o){function r(n,a){if(!i[n]){if(!e[n]){var u="function"==typeof require&&require;if(!a&&u)return u(n,!0);if(s)return s(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[n]={exports:{}};e[n][0].call(l.exports,function(t){var i=e[n][1][t];return r(i?i:t)},l,l.exports,t,e,i,o)}return i[n].exports}for(var s="function"==typeof require&&require,n=0;n<o.length;n++)r(o[n]);return r}({1:[function(t,e,i){var o;!function(){"use strict";o=function(t,e,i,o,r,s){switch(s=s||function(){},this.assetList=t,e){case"obj":this.loadObj(i);break;case"dae":this.loadDae(i)}return this.addAssetMesh(e,i,o,r,s)},o.prototype.loadObj=function(t){var e=document.createElement("a-asset-item");e.setAttribute("id","asset_"+t+"-obj"),e.setAttribute("src","/public/assets/"+t+".obj"),this.assetList.appendChild(e);var i=document.createElement("a-asset-item");i.setAttribute("id","asset_"+t+"-mtl"),i.setAttribute("src","/public/assets/"+t+".mtl"),this.assetList.appendChild(i)},o.prototype.loadDae=function(t){var e=document.createElement("a-asset-item");e.setAttribute("id","asset_"+t+"-dae"),e.setAttribute("src","/public/assets/"+t+".dae"),this.assetList.appendChild(e)},o.prototype.addAssetMesh=function(t,e,i,o,r){i=i||new THREE.Vector3,o=o||new THREE.Vector3(1,1,1);var s=document.createElement("a-entity");switch(s.setAttribute("id","mesh_"+e),t){case"obj":s.setAttribute("obj-model","obj: #asset_"+e+"-obj; mtl: #asset_"+e+"-mtl");break;case"dae":s.setAttribute("collada-model","#asset_"+e+"-dae")}return s.setAttribute("position",i),s.setAttribute("scale",o),document.querySelector("a-scene").appendChild(s),s.addEventListener("loaded",r),s}}(),e.exports=o},{}],2:[function(t,e,i){var o;!function(){"use strict";o=function(t){this.leftController=document.querySelector("#leftController"),this.rightController=document.querySelector("#rightController"),this.ground=document.querySelector("#colBox_0"),this.ballsArray=[],this.timeBack=4e3;for(var e=new THREE.Vector3,i=0,o=t.length;i<o;++i){var r=document.querySelector("#"+t[i]);e.copy(r.getAttribute("position")),e.y+=.5,this.ballsArray.push({entity:r,iniPos:(new THREE.Vector3).copy(e),timeoutBack:void 0}),r.addEventListener("collide",this.onCollide.bind(this))}},o.prototype.onCollide=function(t){var e=this;if(t.detail.body.el===document.querySelector("#colBox_0"))for(var i=0,o=this.ballsArray.length;i<o;++i)if(this.ballsArray[i].entity===t.detail.target.el){var r=this.ballsArray[i];console.log("Found the ball!",r),void 0===r.timeoutBack&&(r.timeoutBack=setTimeout(function(){e.putBallBack(r)},this.timeBack));break}},o.prototype.putBallBack=function(t){t.entity.pause(),t.entity.setAttribute("position",t.iniPos),t.entity.play(),clearTimeout(t.timeoutBack),t.timeoutBack=void 0}}(),e.exports=o},{}],3:[function(t,e,i){var o;!function(){"use strict";o=function(t,e){this.assetList=t,this.imgArray=[],this.nbFrames=Math.min(e.length,12),this.loadAssets(e),this.rotatingFrames=[],this.tempRot=new THREE.Vector3,this.onAssetsLoaded(),this.update()},o.prototype.loadAssets=function(t){for(var e=0;e<t.length;++e){var i=t[e].photos[0].original_size,o=document.createElement("img");o.setAttribute("id","img"+e),o.setAttribute("src","http://ec2-52-27-113-232.us-west-2.compute.amazonaws.com:8080/"+i.url),o.setAttribute("crossorigin","anonymous"),this.assetList.appendChild(o),this.imgArray.push({id:"img"+e,ratio:i.height/i.width})}},o.prototype.onAssetsLoaded=function(){for(var t=document.querySelector("a-scene"),e=document.querySelector("#mesh_cavanagh").getObject3D("mesh"),i=e.children.filter(function(t){return t.name.indexOf("Plane")!==-1}),o=0;o<this.nbFrames;++o){var r=document.createElement("a-image");r.setAttribute("static-body","true"),t.appendChild(r),r.addEventListener("collide",this.onCollide.bind(this));var s=new THREE.Vector3,n=new THREE.Vector3;i[o].geometry.computeBoundingSphere(),s.copy(i[o].geometry.boundingSphere.center),i[o].name.indexOf("Rotated")!==-1&&(n.y=90),r.setAttribute("position",s),r.setAttribute("rotation",n),this.addFrame(r,this.imgArray[o]),i[o].visible=!1}},o.prototype.addFrame=function(t,e){var i=Math.min(2,e.ratio<1?1.5/e.ratio:1.5),o=Math.min(2,e.ratio<1?1.5:1.5*e.ratio);t.setAttribute("width",i),t.setAttribute("height",o),t.setAttribute("src","#"+e.id)},o.prototype.onCollide=function(t){this.rotatingFrames.push({rot:new THREE.Vector3,iniRot:(new THREE.Vector3).copy(t.detail.target.el.getAttribute("rotation")),imgEntity:t.detail.target.el,newAsset:this.imgArray[Math.round(Math.random()*(this.imgArray.length-1))]})},o.prototype.update=function(){for(var t=this.rotatingFrames.length-1;t>=0;--t){var e=this.rotatingFrames[t];e.rot.y<180?(e.rot.y++,e.imgEntity.setAttribute("rotation",this.tempRot.addVectors(e.rot,e.iniRot))):(this.addFrame(e.imgEntity,e.newAsset),this.rotatingFrames.pop())}requestAnimationFrame(this.update.bind(this))}}(),e.exports=o},{}],4:[function(t,e,i){!function(){"use strict";function e(){var t=navigator.getVRDisplays||navigator.getVRDevices;t&&navigator.getVRDisplays().then(function(t){t.length&&!t[0].capabilities.hasPosition&&t[0].isPresenting&&document.querySelector("#camParent").setAttribute("position","0 1.6 0")})}function i(t,e,o){o=o||function(){},document.querySelector("#"+t).getObject3D("mesh")instanceof e?o():setTimeout(function(){i(t,e,o)},250)}function o(t){var e=void 0;e=new s(c,"obj","cavanagh",new THREE.Vector3,new THREE.Vector3(t.x/a,1,t.z/a),function(){i("mesh_cavanagh",THREE.Group,function(){new r(c,tumbDatas.posts)})})}var r=t("./imageLoader.js"),s=t("./assetLoader.js"),n=t("./ballsManager.js"),a=7.92;THREE.ImageUtils.crossOrigin="anonymous",THREE.ImageUtils.loadTexture.crossOrigin="anonymous",THREE.ImageUtils.loadTexture.prototype.crossOrigin="anonymous",THREE.ImageUtils.loadTextureCube.prototype.crossOrigin="anonymous",THREE.ImageUtils.loadTextureCube.crossOrigin="anonymous",THREE.ImageUtils.loadTextureCube.prototype.crossOrigin="anonymous","SamsungChangeSky"in window&&window.SamsungChangeSky({sphere:"/public/samsung_background.jpg"});var u=document.querySelector("a-scene");u.addEventListener("enter-vr",e);var c=document.createElement("a-assets");u.appendChild(c);var l=new s(c,"dae","david",new THREE.Vector3(0,.1,2),new THREE.Vector3(.8,.8,.8));l.setAttribute("dynamic-body","shape: box; mass: 15"),l.setAttribute("rotation",new THREE.Vector3(0,90,0));var d=document.createElement("audio");d.setAttribute("id","amazingGrace2011"),d.setAttribute("src","public/amazingGrace2011.WAV"),c.appendChild(d);var m=new s(c,"obj","speaker",new THREE.Vector3(0,0,(-1.05)),new THREE.Vector3(.4,.4,.4));m.setAttribute("sound","src: #amazingGrace2011;autoplay:true;loop:true"),o({x:a,z:a});var h=["ball1","ball2","ball3"];new n(h);for(var p=0;p<6;++p){var b=document.createElement("a-box");b.setAttribute("static-body","true"),b.setAttribute("id","colBox_"+p),b.setAttribute("visible",!1),p<2?(b.setAttribute("width",8),b.setAttribute("height",.1),b.setAttribute("depth",8)):p<4?(b.setAttribute("width",.1),b.setAttribute("height",8),b.setAttribute("depth",8)):(b.setAttribute("width",8),b.setAttribute("height",8),b.setAttribute("depth",.1)),u.appendChild(b)}document.querySelector("#colBox_0").setAttribute("position",new THREE.Vector3(0,0,0)),document.querySelector("#colBox_1").setAttribute("position",new THREE.Vector3(0,2.8,0)),document.querySelector("#colBox_2").setAttribute("position",new THREE.Vector3((-4.1),1,0)),document.querySelector("#colBox_3").setAttribute("position",new THREE.Vector3(4.1,1,0)),document.querySelector("#colBox_4").setAttribute("position",new THREE.Vector3(0,1,4.1)),document.querySelector("#colBox_5").setAttribute("position",new THREE.Vector3(0,1,(-4.1)))}()},{"./assetLoader.js":1,"./ballsManager.js":2,"./imageLoader.js":3}]},{},[4]);
